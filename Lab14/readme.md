Данная реализация без очереди, поэтому детали теряются, но похер.
